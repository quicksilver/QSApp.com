RewriteEngine On

# Redirect changelog to GitHub releases
RewriteRule ^changelog\.php$ https://github.com/quicksilver/Quicksilver/releases/ [L,R=301]

# Redirect about to homepage
RewriteRule ^about(\.php)?$ / [L,R=301]

# Redirect .php URLs to clean URLs (301 permanent redirect)
RewriteRule ^(.+)\.php$ /$1 [L,R=301]

# Serve /images directly from the document root
RewriteRule ^images/ - [L]

# If the request isn't already under /dist/, rewrite it there
RewriteCond %{REQUEST_URI} !^/dist/
RewriteRule ^(.*)$ /dist/$1 [L]

# For clean URLs, try adding /index.html (for prerendered routes)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}/index.html -f
RewriteRule ^(.*)$ $1/index.html [L]

# If the file still doesn't exist, serve the SPA fallback
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ /dist/__spa-fallback.html [L]

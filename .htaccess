RewriteEngine On

# Redirect changelog to GitHub releases
RewriteRule ^changelog\.php$ https://github.com/quicksilver/Quicksilver/releases/ [L,R=301]

# Redirect about to homepage
RewriteRule ^about(\.php)?$ / [L,R=301]

# Redirect .php URLs to clean URLs (301 permanent redirect)
RewriteRule ^(.+)\.php$ /$1 [L,R=301]

# Serve /images directly from the document root
RewriteRule ^images/ - [L]

# Don't process requests already under /dist/
RewriteCond %{REQUEST_URI} ^/dist/
RewriteRule ^ - [L]

# Try to serve file directly from /dist/
RewriteCond %{DOCUMENT_ROOT}/dist/$1 -f
RewriteRule ^(.*)$ /dist/$1 [L]

# Try to serve prerendered route (directory with index.html)
RewriteCond %{DOCUMENT_ROOT}/dist/$1/index.html -f
RewriteRule ^(.*)$ /dist/$1/index.html [L]

# Fallback to SPA fallback for unmatched routes
RewriteRule ^ /dist/__spa-fallback.html [L]
